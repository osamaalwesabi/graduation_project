<template>
  <div class="mx-auto mt-12 max-w-[1300px] px-4 pb-20" dir="rtl">
    <!-- ğŸ§­ Breadcrumb -->
    <nav
      class="mx-auto max-w-[1300px] px-4 text-slate-500 dark:text-slate-400 text-sm
             flex items-center gap-2 mb-4"
    >
      <RouterLink
        to="/"
        class="hover:text-[#165C75] dark:hover:text-[#7BD4FF]"
      >
        Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
      </RouterLink>
      <span>â€º</span>
      <RouterLink
        to="/about"
        class="hover:text-[#165C75] dark:hover:text-[#7BD4FF]"
      >
        Ø¹Ù† Ø§Ù„Ù‡ÙŠØ¦Ø©
      </RouterLink>
      <span>â€º</span>
      <span class="text-[#000000] dark:text-cyan-300 font-semibold">
        {{ pageData.page_title || 'Ù…Ù† Ù†Ø­Ù†' }}
      </span>
    </nav>

    <!-- ğŸŸ¦ Ø§Ù„Ø¹Ù†ÙˆØ§Ù† + Ø§Ù„ÙˆØµÙ -->
    <div class="mx-auto max-w-[1300px] px-4 mb-6">
      <h1
        class="text-3xl font-bold text-[#000000] dark:text-cyan-300 mb-3 text-right"
      >
        {{ pageData.page_title || 'Ù…Ù† Ù†Ø­Ù†' }}
      </h1>

      <p
        v-if="pageData.page_description"
        class="text-gray-600 dark:text-slate-300 mb-8 leading-relaxed max-w-[850px] text-right"
      >
        {{ pageData.page_description }}
      </p>
      
      <!-- Loading state -->
      <div v-if="loading" class="space-y-4">
        <div class="h-8 bg-gray-200 dark:bg-gray-700 rounded animate-pulse w-3/4"></div>
        <div class="h-4 bg-gray-200 dark:bg-gray-700 rounded animate-pulse w-1/2"></div>
      </div>
    </div>

    <!-- ğŸŸ© Ø§Ù„ÙƒØ§Ø±Ø¯ Ø§Ù„Ø£Ø¨ÙŠØ¶ -->
    <div
      v-if="!loading && pageData.sections"
      class="mx-auto max-w-[1300px] bg-white dark:bg-slate-900 rounded-[40px]
             border border-[#E5EDF0] dark:border-slate-700 shadow-sm
             px-6 md:px-10 py-10 space-y-10"
    >
      <!-- ğŸŸ© Ù…Ù† Ù†Ø­Ù† -->
      <section v-if="pageData.sections.about_us">
        <div
          class="bg-[#E6F4F7] dark:bg-slate-700
                 rounded-3xl p-6 md:p-8
                 border border-[#EAF4F5] dark:border-slate-600"
          dir="rtl"
        >
          <h2
            class="text-xl font-bold text-[#165C75] dark:text-[#7BD4FF]
                   mb-3 flex items-center gap-2"
          >
            <img src="@/assets/images/icon-hex.png" class="w-6 h-6" />
            Ù…Ù† Ù†Ø­Ù†
          </h2>
          <p class="text-slate-600 dark:text-slate-100 leading-7 whitespace-pre-line">
            {{ pageData.sections.about_us }}
          </p>
        </div>
      </section>

      <!-- ğŸŸ© Ø§Ù„Ø±Ø¤ÙŠØ© ÙˆØ§Ù„Ø±Ø³Ø§Ù„Ø© -->
      <section v-if="pageData.sections.vision || pageData.sections.mission" class="grid md:grid-cols-2 gap-6" dir="rtl">
        <!-- Ø§Ù„Ø±Ø¤ÙŠØ© -->
        <div
          v-if="pageData.sections.vision"
          class="bg-[#E6F4F7] dark:bg-slate-700
                 p-6 rounded-3xl
                 border border-[#EAF4F5] dark:border-slate-600"
        >
          <h3
            class="text-xl font-bold text-[#165C75] dark:text-[#7BD4FF]
                   mb-3 flex items-center gap-2"
          >
            <img src="@/assets/images/icon-hex.png" class="w-6 h-6" />
            Ø§Ù„Ø±Ø¤ÙŠØ©
          </h3>
          <p class="text-slate-600 dark:text-slate-100 leading-7 whitespace-pre-line">
            {{ pageData.sections.vision }}
          </p>
        </div>

        <!-- Ø§Ù„Ø±Ø³Ø§Ù„Ø© -->
        <div
          v-if="pageData.sections.mission"
          class="bg-[#E6F4F7] dark:bg-slate-700
                 p-6 rounded-3xl
                 border border-[#D0E7EB] dark:border-slate-600"
        >
          <h3
            class="text-xl font-bold text-[#165C75] dark:text-[#7BD4FF]
                   mb-3 flex items-center gap-2"
          >
            <img src="@/assets/images/icon-hex.png" class="w-6 h-6" />
            Ø§Ù„Ø±Ø³Ø§Ù„Ø©
          </h3>
          <p class="text-slate-600 dark:text-slate-100 leading-7 whitespace-pre-line">
            {{ pageData.sections.mission }}
          </p>
        </div>
      </section>

      <!-- ğŸŸ© Ø§Ù„Ø£Ù‡Ø¯Ø§Ù -->
      <section v-if="pageData.sections.objectives && pageData.sections.objectives.length > 0">
        <div
          class="bg-[#E6F4F7] dark:bg-slate-700
                 rounded-3xl p-6 md:p-8
                 border border-[#D0E7EB] dark:border-slate-600"
          dir="rtl"
        >
          <h2
            class="text-xl font-bold text-[#165C75] dark:text-[#7BD4FF]
                   mb-4 flex items-center gap-2"
          >
            <img src="@/assets/images/icon-hex.png" class="w-6 h-6" />
            Ø§Ù„Ø£Ù‡Ø¯Ø§Ù
          </h2>
          <ol class="list-decimal pr-4 text-slate-600 dark:text-slate-100 leading-8 space-y-2">
            <li v-for="(objective, index) in pageData.sections.objectives" :key="index">
              {{ objective }}
            </li>
          </ol>
        </div>
      </section>

      <!-- ğŸŸ© Ù‚ÙŠÙ…Ù†Ø§ -->
      <section v-if="pageData.sections.values && pageData.sections.values.length > 0" class="mt-4" dir="rtl">
        <div
          class="bg-[#E9F5F6] dark:bg-slate-700
                 rounded-[32px] px-6 md:px-10 py-8
                 border border-[#D8EDEE] dark:border-slate-600"
        >
          <!-- Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø¯Ø§Ø®Ù„ Ø§Ù„ÙƒØ§Ø±Ø¯ -->
          <h3
            class="text-xl font-bold text-[#165C75] dark:text-[#7BD4FF]
                   mb-6 flex items-center gap-2"
          >
            <img src="@/assets/images/icon-hex.png" class="w-6 h-6" />
            Ù‚ÙŠÙ…Ù†Ø§
          </h3>

          <!-- Ø´Ø¨ÙƒØ© Ø§Ù„Ù‚ÙŠÙ… -->
          <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-y-12 gap-x-8">
            <!-- Ù‚ÙŠÙ…Ø© ÙˆØ§Ø­Ø¯Ø© -->
            <div 
              v-for="(value, index) in pageData.sections.values" 
              :key="index"
              class="relative px-6 md:px-10 py-6 text-center"
            >
              <img
                src="@/assets/images/value-corner.svg"
                class="absolute right-4 top-3 w-[32px] h-[38px]"
              />
              <img
                src="@/assets/images/value-corner.svg"
                class="absolute left-4 bottom-3 rotate-180 w-[32px] h-[38px]"
              />
              <h3 class="text-[#165C75] dark:text-[#7BD4FF] font-bold text-xl mb-3">
                {{ value.name }}
              </h3>
              <p v-if="value.description" class="text-slate-600 dark:text-slate-100 leading-8 text-[16px] whitespace-pre-line">
                {{ value.description }}
              </p>
            </div>
          </div>
        </div>
      </section>

      <!-- Error message -->
      <div v-if="error" class="text-center py-8">
        <div class="text-red-500 mb-4">Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</div>
        <button 
          @click="fetchAboutContent"
          class="px-6 py-2 bg-[#165C75] text-white rounded-lg hover:bg-[#134c5f] transition-colors"
        >
          Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰
        </button>
      </div>
    </div>

    <!-- Empty state -->
    <div v-if="!loading && (!pageData.sections || Object.keys(pageData.sections).length === 0)" 
         class="text-center py-12">
      <div class="text-gray-500 mb-4">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù…ØªØ§Ø­Ø© Ø­Ø§Ù„ÙŠØ§Ù‹</div>
      <button 
        @click="fetchAboutContent"
        class="px-6 py-2 bg-[#165C75] text-white rounded-lg hover:bg-[#134c5f] transition-colors"
      >
        ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙØ­Ø©
      </button>
    </div>

    <!-- Loading skeleton for the main card -->
    <div v-else-if="loading" class="mx-auto max-w-[1300px] space-y-8">
      <div class="bg-white dark:bg-slate-900 rounded-[40px] p-8 space-y-6">
        <div v-for="i in 5" :key="i" class="space-y-3">
          <div class="h-6 bg-gray-200 dark:bg-gray-700 rounded animate-pulse w-1/4"></div>
          <div class="h-4 bg-gray-200 dark:bg-gray-700 rounded animate-pulse w-full"></div>
          <div class="h-4 bg-gray-200 dark:bg-gray-700 rounded animate-pulse w-3/4"></div>
        </div>
      </div>
    </div>
  </div>
</template>

<script setup>
import { ref, onMounted } from 'vue'
import { RouterLink } from 'vue-router'

// Reactive data
const pageData = ref({
  page_title: '',
  page_description: '',
  sections: null
})
const loading = ref(true)
const error = ref(null)

// Fetch about content from API
async function fetchAboutContent() {
  try {
    loading.value = true
    error.value = null
    
    // Use your Laravel API endpoint
    const API_URL = import.meta.env.VITE_API_URL || 'http://127.0.0.1:8000/api'
    
    // Try the endpoint
    const response = await fetch(`${API_URL}/about-us-content`)
    
    if (!response.ok) {
      throw new Error(`HTTP error! status: ${response.status}`)
    }
    
    const result = await response.json()
    console.log('Fetched about content:', result)
    
    if (result.success && result.data) {
      // Set the entire data object
      pageData.value = result.data
      
      // Debug log to see the structure
      console.log('pageData structure:', {
        page_title: pageData.value.page_title,
        page_description: pageData.value.page_description,
        sections: pageData.value.sections
      })
    } else {
      throw new Error(result.message || 'Failed to fetch about content')
    }
  } catch (err) {
    error.value = err.message
    console.error('Error fetching about content:', err)
    
    // Fallback to default data for testing
    pageData.value = {
      page_title: 'Ù…Ù† Ù†Ø­Ù†',
      page_description: 'ØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ù‡ÙŠØ¦Ø© Ø§Ù„Ø¹Ø§Ù…Ø© Ù„ØªÙ†Ù…ÙŠØ© Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹ Ø§Ù„ØµØºÙŠØ±Ø© ÙˆØ§Ù„Ø£ØµØºØ±ØŒ Ø±Ø¤ÙŠØªÙ‡Ø§ ÙˆØ±Ø³Ø§Ù„ØªÙ‡Ø§ ÙˆØ£Ù‡Ø¯Ø§ÙÙ‡Ø§ ÙˆÙ‚ÙŠÙ…Ù‡Ø§ Ø§Ù„ØªÙŠ ØªØ®Ø¯Ù… Ø±ÙˆØ§Ø¯ Ø§Ù„Ø£Ø¹Ù…Ø§Ù„ ÙˆØ£ØµØ­Ø§Ø¨ Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹ Ø§Ù„ØµØºÙŠØ±Ø©.',
      sections: {
        about_us: 'ØªØ£Ø³Ø³Øª Ø§Ù„Ù‡ÙŠØ¦Ø© Ø§Ù„Ø¹Ø§Ù…Ø© Ù„ØªÙ†Ù…ÙŠØ© Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹ Ø§Ù„ØµØºÙŠØ±Ø© ÙˆØ§Ù„Ø£ØµØºØ± ÙÙŠ Ù…Ø§Ø±Ø³ 2021 Ø¨Ù‡Ø¯Ù ØªÙ†Ø¸ÙŠÙ… ÙˆØªÙ†Ù…ÙŠØ© Ù‚Ø·Ø§Ø¹ Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹ Ø§Ù„ØµØºÙŠØ±Ø©...',
        vision: 'Ù…Ø¬ØªÙ…Ø¹ Ù…Ù†ØªØ¬ Ù‚Ø§Ø¯Ø± Ø¹Ù„Ù‰ ØªÙˆØ¸ÙŠÙ Ù…ÙˆØ§Ø±Ø¯Ù‡ Ø¨Ù…Ø§ ÙŠØ¹Ø²Ø² Ø§Ù„Ø§Ù‚ØªØµØ§Ø¯ Ø§Ù„ÙˆØ·Ù†ÙŠ.',
        mission: 'ØªÙ†Ù…ÙŠØ© Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹ Ø§Ù„ØµØºÙŠØ±Ø© ÙˆØ§Ù„Ø£ØµØºØ± Ù…Ù† Ø®Ù„Ø§Ù„ ØªÙˆÙÙŠØ± Ø§Ù„Ø¨ÙŠØ¦Ø© Ø§Ù„Ø¯Ø§Ø¹Ù…Ø© ÙˆÙ†Ø´Ø± Ø§Ù„Ù…Ø¹Ø±ÙØ© ÙˆØªÙˆØ¸ÙŠÙ Ø§Ù„Ø¥Ù…ÙƒØ§Ù†Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø© Ø¨Ø·Ø±Ù‚ Ù…Ø¨ØªÙƒØ±Ø© ÙˆÙ…ØªÙƒØ§Ù…Ù„Ø©.',
        objectives: [
          'ØªÙˆÙÙŠØ± Ø¨ÙŠØ¦Ø© Ø¯Ø§Ø¹Ù…Ø© ØªØ³Ø§Ø¹Ø¯ Ø¹Ù„Ù‰ ØªÙ†Ù…ÙŠØ© Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹ Ø§Ù„ØµØºÙŠØ±Ø©...',
          'ÙˆØ¶Ø¹ Ø§Ù„Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ§Øª ÙˆØ§Ù„Ø³ÙŠØ§Ø³Ø§Øª Ø§Ù„ÙˆØ·Ù†ÙŠØ© Ø§Ù„Ø¯Ø§Ø¹Ù…Ø©...',
          'Ù†Ø´Ø± Ø§Ù„Ù…Ø¹Ø±ÙØ© Ø¨Ù…Ø§ ÙŠØ­Ù‚Ù‚ Ø§Ù„ÙØ§Ø¹Ù„ÙŠØ© ÙˆØ§Ù„Ø§Ø³ØªØ¯Ø§Ù…Ø©...',
          'Ø¯Ø¹Ù… Ù†ÙØ§Ø° Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹ Ø§Ù„ØµØºÙŠØ±Ø©...'
        ],
        values: [
          { name: 'Ø§Ù„Ù†Ø²Ø§Ù‡Ø©', description: 'ØªÙ†ÙÙŠØ° ÙƒØ§ÙØ© Ø§Ù„Ù…Ù‡Ø§Ù… ÙˆØ§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª Ø¨Ø£Ù…Ø§Ù†Ø© ÙˆØµØ¯Ù‚ ÙˆØ§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø¨ÙƒÙ„ Ù…Ø§ Ù‡Ùˆ Ø£Ø®Ù„Ø§Ù‚ÙŠ.' },
          { name: 'Ø§Ù„Ø´ÙØ§ÙÙŠØ©', description: 'Ø§Ù„Ø¥ÙØµØ§Ø­ Ø¹Ù† Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø¨Ø´ÙƒÙ„ Ù…Ø³ØªÙ…Ø± ÙˆÙ…Ù†ØªØ¸Ù… ÙˆØªÙ…ÙƒÙŠÙ† Ø§Ù„Ø¬Ù…ÙŠØ¹ Ù…Ù† Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª.' },
          { name: 'Ø§Ù„Ù…Ø±ÙˆÙ†Ø©', description: 'Ø§Ù„Ù‚Ø¯Ø±Ø© Ø¹Ù„Ù‰ Ø§Ù„ØªÙƒÙŠÙ‘Ù Ù…Ø¹ Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ù„ØªØ­Ù‚ÙŠÙ‚ Ø£Ø¯Ø§Ø¡ Ù…Ø³ØªÙ‚Ø±.' },
          { name: 'Ø§Ù„Ø´Ù…ÙˆÙ„', description: 'ÙˆØµÙˆÙ„ Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ù…Ø§Ù„ÙŠØ© ÙˆØºÙŠØ± Ø§Ù„Ù…Ø§Ù„ÙŠØ© Ù„ÙƒÙ„ Ø§Ù„Ù…Ù†Ø§Ø·Ù‚ ÙˆØ§Ù„Ù…Ø­Ø§ÙØ¸Ø§Øª.' },
          { name: 'Ø§Ù„ØªÙƒØ§Ù…Ù„', description: 'ØªÙˆØ­ÙŠØ¯ Ø¬Ù‡ÙˆØ¯ Ø§Ù„Ø¹Ø§Ù…Ù„ÙŠÙ† Ù„ØªØ­Ù‚ÙŠÙ‚ Ø³Ù„Ø³Ù„Ø© Ø£Ù‡Ø¯Ø§Ù Ù…ØªÙƒØ§Ù…Ù„Ø©.' },
          { name: 'Ø§Ù„Ø§Ø¨ØªÙƒØ§Ø±', description: 'ØªÙ‚Ø¯ÙŠÙ… Ø­Ù„ÙˆÙ„ Ù…Ø¨ØªÙƒØ±Ø© ØªØ¯Ø¹Ù… ØªØ·ÙˆÙŠØ± Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹ Ø§Ù„ØµØºÙŠØ±Ø© ÙˆØ§Ù„Ø£ØµØºØ±.' }
        ]
      }
    }
  } finally {
    loading.value = false
  }
}

// Fetch data when component mounts
onMounted(() => {
  fetchAboutContent()
})
</script>

<style scoped>
/* Add any custom styles if needed */
.whitespace-pre-line {
  white-space: pre-line;
}
</style>